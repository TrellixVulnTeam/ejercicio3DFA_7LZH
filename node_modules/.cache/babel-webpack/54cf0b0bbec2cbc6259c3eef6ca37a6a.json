{"ast":null,"code":"import _asyncToGenerator from \"/home/pascuord/Documentos/uoc/masterDesarrolloAplicacionesPaginasWeb/desarrolloFrontEndAvanzado/pec2/ejercicio3/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { FormControl, Validators } from '@angular/forms';\nimport { AuthDTO } from 'src/app/Models/auth.dto';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/Services/auth.service\";\nimport * as i3 from \"src/app/Services/shared.service\";\nimport * as i4 from \"src/app/Services/header-menus.service\";\nimport * as i5 from \"src/app/Services/local-storage.service\";\nimport * as i6 from \"@angular/router\";\nimport * as i7 from \"@angular/common\";\n\nfunction LoginComponent_div_16_span_1_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Email is required\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction LoginComponent_div_16_span_1_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Email not a valid format.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction LoginComponent_div_16_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 10);\n    i0.ɵɵtemplate(1, LoginComponent_div_16_span_1_span_1_Template, 2, 0, \"span\", 8);\n    i0.ɵɵtemplate(2, LoginComponent_div_16_span_1_div_2_Template, 2, 0, \"div\", 8);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.email.errors.required);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.email.errors.pattern);\n  }\n}\n\nfunction LoginComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, LoginComponent_div_16_span_1_Template, 3, 2, \"span\", 9);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.email.errors && (ctx_r0.email.touched || ctx_r0.email.dirty));\n  }\n}\n\nfunction LoginComponent_div_17_span_1_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Password is required\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction LoginComponent_div_17_span_1_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Password must be greater tha 8 characters\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction LoginComponent_div_17_span_1_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Password can be max 16 characters long\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction LoginComponent_div_17_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 10);\n    i0.ɵɵtemplate(1, LoginComponent_div_17_span_1_span_1_Template, 2, 0, \"span\", 8);\n    i0.ɵɵtemplate(2, LoginComponent_div_17_span_1_span_2_Template, 2, 0, \"span\", 8);\n    i0.ɵɵtemplate(3, LoginComponent_div_17_span_1_span_3_Template, 2, 0, \"span\", 8);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.password.errors.required);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.password.errors.minlength);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.password.errors.maxlength);\n  }\n}\n\nfunction LoginComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, LoginComponent_div_17_span_1_Template, 4, 3, \"span\", 9);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.password.errors && (ctx_r1.password.touched || ctx_r1.password.dirty));\n  }\n}\n\nexport class LoginComponent {\n  constructor(formBuilder, authService, sharedService, headerMenusService, localStorageService, router) {\n    this.formBuilder = formBuilder;\n    this.authService = authService;\n    this.sharedService = sharedService;\n    this.headerMenusService = headerMenusService;\n    this.localStorageService = localStorageService;\n    this.router = router;\n    this.loginUser = new AuthDTO('', '', '', '');\n    this.email = new FormControl('', [Validators.required, Validators.pattern('[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,4}$')]);\n    this.password = new FormControl('', [Validators.required, Validators.minLength(8), Validators.maxLength(16)]);\n    this.loginForm = this.formBuilder.group({\n      email: this.email,\n      password: this.password\n    });\n  }\n\n  ngOnInit() {}\n\n  login() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      let responseOK = false;\n      let errorResponse;\n      _this.loginUser.email = _this.email.value;\n      _this.loginUser.password = _this.password.value;\n\n      _this.authService.login(_this.loginUser).subscribe(authResult => {\n        responseOK = true;\n        _this.loginUser.user_id = authResult.user_id;\n        _this.loginUser.access_token = authResult.access_token; // save token to localstorage for next requests\n\n        _this.localStorageService.set('user_id', _this.loginUser.user_id);\n\n        _this.localStorageService.set('access_token', _this.loginUser.access_token);\n      }, error => {\n        responseOK = false;\n        errorResponse = error.error;\n        const headerInfo = {\n          showAuthSection: false,\n          showNoAuthSection: true\n        };\n\n        _this.headerMenusService.headerManagement.next(headerInfo);\n\n        _this.sharedService.errorLog(error.error);\n      }, () => {\n        _this.sharedService.managementToast('loginFeedback', responseOK, errorResponse);\n\n        if (responseOK) {\n          const headerInfo = {\n            showAuthSection: true,\n            showNoAuthSection: false\n          }; // update options menu\n\n          _this.headerMenusService.headerManagement.next(headerInfo);\n\n          _this.router.navigateByUrl('home');\n        }\n      });\n    })();\n  }\n\n}\n\nLoginComponent.ɵfac = function LoginComponent_Factory(t) {\n  return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.SharedService), i0.ɵɵdirectiveInject(i4.HeaderMenusService), i0.ɵɵdirectiveInject(i5.LocalStorageService), i0.ɵɵdirectiveInject(i6.Router));\n};\n\nLoginComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: LoginComponent,\n  selectors: [[\"app-login\"]],\n  decls: 18,\n  vars: 6,\n  consts: [[2, \"margin-left\", \"auto\", \"margin-right\", \"auto\"], [\"id\", \"loginFeedback\"], [3, \"formGroup\", \"ngSubmit\"], [\"for\", \"email\"], [\"type\", \"email\", 3, \"formControl\"], [\"for\", \"password\"], [\"type\", \"password\", 3, \"formControl\"], [\"type\", \"submit\", 3, \"disabled\"], [4, \"ngIf\"], [\"style\", \"color: red\", 4, \"ngIf\"], [2, \"color\", \"red\"]],\n  template: function LoginComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelement(1, \"p\", 1);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"div\");\n      i0.ɵɵelementStart(3, \"h1\");\n      i0.ɵɵtext(4, \"Login\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"form\", 2);\n      i0.ɵɵlistener(\"ngSubmit\", function LoginComponent_Template_form_ngSubmit_5_listener() {\n        return ctx.login();\n      });\n      i0.ɵɵelementStart(6, \"div\");\n      i0.ɵɵelementStart(7, \"label\", 3);\n      i0.ɵɵtext(8, \"Email: \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(9, \"input\", 4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"div\");\n      i0.ɵɵelementStart(11, \"label\", 5);\n      i0.ɵɵtext(12, \"Password: \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(13, \"input\", 6);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"button\", 7);\n      i0.ɵɵtext(15, \"Login\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(16, LoginComponent_div_16_Template, 2, 1, \"div\", 8);\n      i0.ɵɵtemplate(17, LoginComponent_div_17_Template, 2, 1, \"div\", 8);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"formGroup\", ctx.loginForm);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"formControl\", ctx.email);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"formControl\", ctx.password);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"disabled\", !ctx.loginForm.valid);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.email.errors);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.password.errors);\n    }\n  },\n  directives: [i1.ɵNgNoValidate, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.DefaultValueAccessor, i1.NgControlStatus, i1.FormControlDirective, i7.NgIf],\n  styles: [\".error[_ngcontent-%COMP%] {\\n  color: red;\\n}\\n\\n#loginFeedback[_ngcontent-%COMP%] {\\n  visibility: hidden;\\n  min-width: 250px;\\n  color: #fff;\\n  text-align: center;\\n  border-radius: 10px;\\n  padding: 16px;\\n  z-index: 1;\\n  font-size: 14px;\\n  margin-left: auto;\\n  margin-right: auto;\\n}\\n\\n#loginFeedback.requestOk[_ngcontent-%COMP%] {\\n  background-color: green;\\n}\\n\\n#loginFeedback.requestKo[_ngcontent-%COMP%] {\\n  background-color: red;\\n}\\n\\n#loginFeedback.show[_ngcontent-%COMP%] {\\n  visibility: visible;\\n  -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;\\n  animation: fadein 0.5s, fadeout 0.5s 2.5s;\\n}\\n\\n@-webkit-keyframes fadein {\\n  from {\\n    bottom: 0;\\n    opacity: 0;\\n  }\\n  to {\\n    bottom: 30px;\\n    opacity: 1;\\n  }\\n}\\n\\n@keyframes fadein {\\n  from {\\n    bottom: 0;\\n    opacity: 0;\\n  }\\n  to {\\n    bottom: 30px;\\n    opacity: 1;\\n  }\\n}\\n\\n@-webkit-keyframes fadeout {\\n  from {\\n    bottom: 30px;\\n    opacity: 1;\\n  }\\n  to {\\n    bottom: 0;\\n    opacity: 0;\\n  }\\n}\\n\\n@keyframes fadeout {\\n  from {\\n    bottom: 30px;\\n    opacity: 1;\\n  }\\n  to {\\n    bottom: 0;\\n    opacity: 0;\\n  }\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2luLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsVUFBQTtBQUNGOztBQUVBO0VBQ0Usa0JBQUE7RUFDQSxnQkFBQTtFQUNBLFdBQUE7RUFDQSxrQkFBQTtFQUNBLG1CQUFBO0VBQ0EsYUFBQTtFQUNBLFVBQUE7RUFDQSxlQUFBO0VBQ0EsaUJBQUE7RUFDQSxrQkFBQTtBQUNGOztBQUVBO0VBQ0UsdUJBQUE7QUFDRjs7QUFFQTtFQUNFLHFCQUFBO0FBQ0Y7O0FBRUE7RUFDRSxtQkFBQTtFQUNBLGlEQUFBO0VBQ0EseUNBQUE7QUFDRjs7QUFFQTtFQUNFO0lBQ0UsU0FBQTtJQUNBLFVBQUE7RUFDRjtFQUNBO0lBQ0UsWUFBQTtJQUNBLFVBQUE7RUFDRjtBQUNGOztBQUVBO0VBQ0U7SUFDRSxTQUFBO0lBQ0EsVUFBQTtFQUFGO0VBRUE7SUFDRSxZQUFBO0lBQ0EsVUFBQTtFQUFGO0FBQ0Y7O0FBR0E7RUFDRTtJQUNFLFlBQUE7SUFDQSxVQUFBO0VBREY7RUFHQTtJQUNFLFNBQUE7SUFDQSxVQUFBO0VBREY7QUFDRjs7QUFJQTtFQUNFO0lBQ0UsWUFBQTtJQUNBLFVBQUE7RUFGRjtFQUlBO0lBQ0UsU0FBQTtJQUNBLFVBQUE7RUFGRjtBQUNGIiwiZmlsZSI6ImxvZ2luLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmVycm9yIHtcclxuICBjb2xvcjogcmVkO1xyXG59XHJcblxyXG4jbG9naW5GZWVkYmFjayB7XHJcbiAgdmlzaWJpbGl0eTogaGlkZGVuO1xyXG4gIG1pbi13aWR0aDogMjUwcHg7XHJcbiAgY29sb3I6ICNmZmY7XHJcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gIGJvcmRlci1yYWRpdXM6IDEwcHg7XHJcbiAgcGFkZGluZzogMTZweDtcclxuICB6LWluZGV4OiAxO1xyXG4gIGZvbnQtc2l6ZTogMTRweDtcclxuICBtYXJnaW4tbGVmdDogYXV0bztcclxuICBtYXJnaW4tcmlnaHQ6IGF1dG87XHJcbn1cclxuXHJcbiNsb2dpbkZlZWRiYWNrLnJlcXVlc3RPayB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogZ3JlZW47XHJcbn1cclxuXHJcbiNsb2dpbkZlZWRiYWNrLnJlcXVlc3RLbyB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogcmVkO1xyXG59XHJcblxyXG4jbG9naW5GZWVkYmFjay5zaG93IHtcclxuICB2aXNpYmlsaXR5OiB2aXNpYmxlO1xyXG4gIC13ZWJraXQtYW5pbWF0aW9uOiBmYWRlaW4gMC41cywgZmFkZW91dCAwLjVzIDIuNXM7XHJcbiAgYW5pbWF0aW9uOiBmYWRlaW4gMC41cywgZmFkZW91dCAwLjVzIDIuNXM7XHJcbn1cclxuXHJcbkAtd2Via2l0LWtleWZyYW1lcyBmYWRlaW4ge1xyXG4gIGZyb20ge1xyXG4gICAgYm90dG9tOiAwO1xyXG4gICAgb3BhY2l0eTogMDtcclxuICB9XHJcbiAgdG8ge1xyXG4gICAgYm90dG9tOiAzMHB4O1xyXG4gICAgb3BhY2l0eTogMTtcclxuICB9XHJcbn1cclxuXHJcbkBrZXlmcmFtZXMgZmFkZWluIHtcclxuICBmcm9tIHtcclxuICAgIGJvdHRvbTogMDtcclxuICAgIG9wYWNpdHk6IDA7XHJcbiAgfVxyXG4gIHRvIHtcclxuICAgIGJvdHRvbTogMzBweDtcclxuICAgIG9wYWNpdHk6IDE7XHJcbiAgfVxyXG59XHJcblxyXG5ALXdlYmtpdC1rZXlmcmFtZXMgZmFkZW91dCB7XHJcbiAgZnJvbSB7XHJcbiAgICBib3R0b206IDMwcHg7XHJcbiAgICBvcGFjaXR5OiAxO1xyXG4gIH1cclxuICB0byB7XHJcbiAgICBib3R0b206IDA7XHJcbiAgICBvcGFjaXR5OiAwO1xyXG4gIH1cclxufVxyXG5cclxuQGtleWZyYW1lcyBmYWRlb3V0IHtcclxuICBmcm9tIHtcclxuICAgIGJvdHRvbTogMzBweDtcclxuICAgIG9wYWNpdHk6IDE7XHJcbiAgfVxyXG4gIHRvIHtcclxuICAgIGJvdHRvbTogMDtcclxuICAgIG9wYWNpdHk6IDA7XHJcbiAgfVxyXG59XHJcbiJdfQ== */\"]\n});","map":{"version":3,"sources":["/home/pascuord/Documentos/uoc/masterDesarrolloAplicacionesPaginasWeb/desarrolloFrontEndAvanzado/pec2/ejercicio3/src/app/Components/login/login.component.ts","/home/pascuord/Documentos/uoc/masterDesarrolloAplicacionesPaginasWeb/desarrolloFrontEndAvanzado/pec2/ejercicio3/src/app/Components/login/login.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport {\n  FormBuilder,\n  FormControl,\n  FormGroup,\n  Validators,\n} from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { AuthDTO } from 'src/app/Models/auth.dto';\nimport { HeaderMenus } from 'src/app/Models/header-menus.dto';\nimport { AuthService } from 'src/app/Services/auth.service';\nimport { HeaderMenusService } from 'src/app/Services/header-menus.service';\nimport { LocalStorageService } from 'src/app/Services/local-storage.service';\nimport { SharedService } from 'src/app/Services/shared.service';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.scss'],\n})\nexport class LoginComponent implements OnInit {\n  loginUser: AuthDTO;\n  email: FormControl;\n  password: FormControl;\n  loginForm: FormGroup;\n\n  constructor(\n    private formBuilder: FormBuilder,\n    private authService: AuthService,\n    private sharedService: SharedService,\n    private headerMenusService: HeaderMenusService,\n    private localStorageService: LocalStorageService,\n    private router: Router\n  ) {\n    this.loginUser = new AuthDTO('', '', '', '');\n\n    this.email = new FormControl('', [\n      Validators.required,\n      Validators.pattern('[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,4}$'),\n    ]);\n\n    this.password = new FormControl('', [\n      Validators.required,\n      Validators.minLength(8),\n      Validators.maxLength(16),\n    ]);\n\n    this.loginForm = this.formBuilder.group({\n      email: this.email,\n      password: this.password,\n    });\n  }\n\n  ngOnInit(): void {}\n\n  async login(): Promise<void> {\n    let responseOK: boolean = false;\n    let errorResponse: any;\n\n    this.loginUser.email = this.email.value;\n    this.loginUser.password = this.password.value;\n\n    this.authService.login(this.loginUser).subscribe(\n      (authResult) => {\n        responseOK = true;\n        this.loginUser.user_id = authResult.user_id;\n        this.loginUser.access_token = authResult.access_token;\n        // save token to localstorage for next requests\n        this.localStorageService.set('user_id', this.loginUser.user_id);\n        this.localStorageService.set(\n          'access_token',\n          this.loginUser.access_token\n        );\n      },\n      (error: any) => {\n        responseOK = false;\n        errorResponse = error.error;\n        const headerInfo: HeaderMenus = {\n          showAuthSection: false,\n          showNoAuthSection: true,\n        };\n        this.headerMenusService.headerManagement.next(headerInfo);\n        this.sharedService.errorLog(error.error);\n      },\n      () => {\n        this.sharedService.managementToast(\n          'loginFeedback',\n          responseOK,\n          errorResponse\n        );\n\n        if (responseOK) {\n          const headerInfo: HeaderMenus = {\n            showAuthSection: true,\n            showNoAuthSection: false,\n          };\n          // update options menu\n          this.headerMenusService.headerManagement.next(headerInfo);\n          this.router.navigateByUrl('home');\n        }\n      }\n    );\n  }\n}\n","<div style=\"margin-left: auto; margin-right: auto\">\n  <p id=\"loginFeedback\"></p>\n</div>\n<div>\n  <h1>Login</h1>\n  <form [formGroup]=\"loginForm\" (ngSubmit)=\"login()\">\n    <div>\n      <label for=\"email\">Email: </label>\n      <input type=\"email\" [formControl]=\"email\" />\n    </div>\n\n    <div>\n      <label for=\"password\">Password: </label>\n      <input type=\"password\" [formControl]=\"password\" />\n    </div>\n\n    <button type=\"submit\" [disabled]=\"!loginForm.valid\">Login</button>\n  </form>\n</div>\n\n<div *ngIf=\"email.errors\">\n  <span\n    style=\"color: red\"\n    *ngIf=\"email.errors && (email.touched || email.dirty)\"\n  >\n    <span *ngIf=\"email.errors.required\">Email is required</span>\n    <div *ngIf=\"email.errors.pattern\">Email not a valid format.</div>\n  </span>\n</div>\n\n<div *ngIf=\"password.errors\">\n  <span\n    style=\"color: red\"\n    *ngIf=\"password.errors && (password.touched || password.dirty)\"\n  >\n    <span *ngIf=\"password.errors.required\">Password is required</span>\n    <span *ngIf=\"password.errors.minlength\"\n      >Password must be greater tha 8 characters</span\n    >\n    <span *ngIf=\"password.errors.maxlength\"\n      >Password can be max 16 characters long</span\n    >\n  </span>\n</div>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}